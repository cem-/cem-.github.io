<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>c em|me</title>
	<meta name="author" content="Carl Mehner">
    
	<link rel="icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAiNJREFUOI2Nks9LVFEcxT/3vjfm+KOZTDAnzUmxZtoUoqFhktAPhBbTrj9AJLBFhC1CSqZdCbaIgnYt3ES0DCvNgqhAiEqJJq0JBx1FR+nNOM5T37zbopkhwhk8q8vhnvO953uP6FIDAI3mXPxMYmrJo9K2pAC00iJzb6f3CzAGJHWgfrp//JE5H29FUVCcRXR4cv3ApeZbrhbPbR04tLG4dhSFRGBVBXxDVQHfJ0D7Xzh943WPGTE6lGWXxMbC7a4Wz10d/pkqhF0V8I0DL0ZEMEdnYlK8v/y0GTE6ALCVBIS+kyfn/HVpIcUWSgmhCQtQ+QxElxo4DsSAn1mytrvpQUn9nrld1eVGmb/yLWBttzQFuEN9Lx+Gro0+AY5lTa21zaaFx197k6GYB/gI5P0yoRSao8I5Hx58fxPwAxdn700E9PKihXRy05m9mH8HtpIH+048lQ6Zmhl4c18rK/rdcL29P3znXVD9XWBBgy1nnWtKOuQy8KwxeMoAIkDI6XX/cta5lwoZCCDhvdLaDWxkuOcAqVmjN/l95UhyZtWHrYS7rWYwb4QREVzLnrM9WB6ZaV7/sXoOYAWUu61maEfVLQQdSCNQACglo8OT5yvPNng756/mzM1oAoBUxDicU2oiTaZI34prdk+kZo2T2EqPjYYvx0bD+UcKbOHQ4vsu+F8BmyKTrxboiH9erFaWLYUUajutspXQXcVmaWPFFPABMP8AmgnNwTEAUpoAAAAASUVORK5CYII="> 
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link type="text/css" rel="stylesheet" href="cem.css" />
	
</head>

<body>

<header>
	<nav>
		<ul>
			<li><a href="/index.html"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAiNJREFUOI2Nks9LVFEcxT/3vjfm+KOZTDAnzUmxZtoUoqFhktAPhBbTrj9AJLBFhC1CSqZdCbaIgnYt3ES0DCvNgqhAiEqJJq0JBx1FR+nNOM5T37zbopkhwhk8q8vhnvO953uP6FIDAI3mXPxMYmrJo9K2pAC00iJzb6f3CzAGJHWgfrp//JE5H29FUVCcRXR4cv3ApeZbrhbPbR04tLG4dhSFRGBVBXxDVQHfJ0D7Xzh943WPGTE6lGWXxMbC7a4Wz10d/pkqhF0V8I0DL0ZEMEdnYlK8v/y0GTE6ALCVBIS+kyfn/HVpIcUWSgmhCQtQ+QxElxo4DsSAn1mytrvpQUn9nrld1eVGmb/yLWBttzQFuEN9Lx+Gro0+AY5lTa21zaaFx197k6GYB/gI5P0yoRSao8I5Hx58fxPwAxdn700E9PKihXRy05m9mH8HtpIH+048lQ6Zmhl4c18rK/rdcL29P3znXVD9XWBBgy1nnWtKOuQy8KwxeMoAIkDI6XX/cta5lwoZCCDhvdLaDWxkuOcAqVmjN/l95UhyZtWHrYS7rWYwb4QREVzLnrM9WB6ZaV7/sXoOYAWUu61maEfVLQQdSCNQACglo8OT5yvPNng756/mzM1oAoBUxDicU2oiTaZI34prdk+kZo2T2EqPjYYvx0bD+UcKbOHQ4vsu+F8BmyKTrxboiH9erFaWLYUUajutspXQXcVmaWPFFPABMP8AmgnNwTEAUpoAAAAASUVORK5CYII=" alt="cem.me" />
            </a></li>
			<li><a href="all.html">index</a></li>
			<li><a href="about.html">about</a></li>
			<li><a href="https://plus.google.com/u/0/115606090533118002214?prsrc=3&amp;rel=me" rel="publisher" target="_top" >
				<img src="https://ssl.gstatic.com/images/icons/gplus-16.png" alt="Google+" class="glogo" />
			</a></li>
		</ul>
	</nav>
    
<section id="topTitle">
  <p>&nbsp;</p><img class=mainLogo src="logo.png" alt="cem.me"/><br /><h2>carl mehner's blog</h2>
</section>


</header>


<!-- -above is template for headers and style- -->

<article>
  <header>
	  <h1 class="title"><a href="papers/cve-2014-4449">iOS 8.1 and CVE-2014-4449</a></h1>
	  <time class="pubdate" datetime="2014-10-20">2014-10-20</time>

  </header>
  <p>Today, Apple released security advisory <a href="http://support.apple.com/en-us/HT203119" target="_blank">APPLE-SA-2014-10-20-1</a> for iOS 8.1 that includes <a href="https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-4449" target="_blank">CVE-2014-4449</a>.</p>
  <p>This relates to a TLS certificate validation vulnerability in the clients accessing iCloud affecting bookmarks, calendar, tasks, and possibly other data types allowing for modification and disclosure of data.</p>
  <p>Exposure of sensitive reminders, meetings, bookmarks (including bookmarklets that could allow logins to other saved websites). Users may store sensitive data within these data objects that are synced to iCloud, these are at risk of exposure through this vulnerability.</p>
  <dl>
  <dt><b>Data Disclosed Includes:</b></dt>
  <dd>User Display Name</dd>
  <dd>Apple DAV Push Token</dd>
  <dd>Owner ID</dd>
  <dd>X-MobileMe-Auth Token (encoded in b64, prepended Owner ID)</dd>
  <dd>Push Key (prepended Owner ID)</dd>
  <dd>DAV Sync Token</dd>
  <dd>
   <dl>
    <dt><b>The full gziped text of the following data types:</b></dt>
    <dd>Reminders</dd>
    <dd>Calendar Events</dd>
    <dd>Safari Bookmarks</dd>
   </dl>
  </dd>
  </dl>
  
  <dl>
  <dt><b>Connections not validated include:</b></dt>
  <dd>p11-caldav.icloud.com</dd>
  <dd>p11-bookmarks.icloud.com</dd>
  </dl>
  <pre>
<code>
Vulnerability Disclosure Timeline:
==================================
2014-07-15:     Researcher discovery
2014-07-16:     Vendor Notification
2014-07-17:     Vendor Confirmation of reciept of report
2014-10-02:     Vendor Response/Feedback
2014-10-20:     Vendor Fix/Patch
2014-10-20:     Public Disclosure

Impact
==================================
CVSS Severity (version 2.0):
CVSS v2 Base Score: 6.8 (MEDIUM)
Impact Subscore: 6.4
Exploitability Subscore: 8.6
CVSS Version 2 Metrics:
Access Vector: Network exploitable
Access Complexity: Medium
Authentication: Not required to exploit
Impact Type: Allows unauthorized disclosure of
    information; Allows unauthorized modification;
    Allows disruption of service
</code>
  </pre>

  <p><i>--speculation ahead--</i><br />According to <a href="https://www.youtube.com/watch?v=cwmmLRUYaQ8" target="_blank">ElcomSoft</a>, a Russian mobile forensics company, the data gathered from the MobileMe-Auth Token might be able to be used to get additional authentication tokens as well as a number of other interesting things like iOS iCloud backups. These are encrypted using retrievable keys that are also stored in the cloud.</p>
  <p>So, assumedly, one executing an attack on CVE-2014-4449, would have the ability to not only see just the data going over the unauthenticated streams to the calendar, reminders, and bookmarks, but also could pivot those authentication keys to download and decrypt backups of iOS devices. Once a backup is retrieved and decrypted the attacker has access to all of the iPhone data using a variety of free or paid tools for forensic analysis.</p>
</article>



<article>
  <header>
	  <h1 class="title"><a href="20141019-tls-quotes.html">TLS Quotes</a></h1>
	  <time class="pubdate" datetime="2014-10-19">2014-10-19</time>

  </header>
  <p>Just some completely random quotes about TLS following the POODLE vulnerability.</p>
  <blockquote><p>"Remember, everything less than TLS 1.2 with an AEAD mode is cryptographically broken."<br />
  -<a href="https://www.imperialviolet.org/2014/10/14/poodle.html" target="_blank">Adam Langley</a></p></blockquote>
  <blockquote><p>"TLS_FALLBACK_SCSV is mainly about those vulnerabilities that we *can't* list <a href="https://datatracker.ietf.org/doc/draft-ietf-tls-downgrade-scsv/" target="_blank">there</a> yet."<br />&mdash; <a href="http://www.ietf.org/mail-archive/web/tls/current/msg13926.html" target="_blank">Bodo MÃ¶ller</a></p></blockquote>
</article>


<article>
  <header>
	  <h1 class="title"><a href="papers/emailcerts">[Not?] Misissued Certificates:</a></h1>
	  <time class="pubdate" datetime="2014-04-03">2014-04-03</time>
  <h4>or, how I was able to get over 2500 certificates for domains that I do not own</h4>

  </header>
  <p>Four years ago, in 2010, <a target="_blank" href="https://www.seifried.org/security/">Kurt Seifried</a> released <a target="_blank" href="http://www.linux-magazine.com/w3/issue/114/054-055_kurt.pdf">research</a> on how certificate authorities (CAs) validated hostnames in SSL certificate requests. <a href="https://afreak.ca/blog/author/ckeigher/" target="_blank">Colin Keigher</a> followed on by with an <a href="https://afreak.ca/blog/whos-letting-me-become-ssladmin/" target="_blank">actual implementation</a> of that research resulting in his finding of five email providers that allowed the registering of addresses, which effectively allowed him to garner certificates for those domains.</p>
  <p>I found that this avenue for procuring certificates still exists in at least two mail providers, which means that I was able to get upwards of 2,500 certificates for various domains that I do not own.</p>
  <p><a href="papers/emailcerts">[...READ MORE...]</a></p>
</article>


<article>
  <header>
	  <h1 class="title"><a href="papers/hpkpwn">Bug in Chrome security feature can fill up your hard drive &amp; crash the browser</a></h1>
	  <time class="pubdate" datetime="2014-02-20">2014-02-20</time>

  </header>
  <p>The security feature in question is one that I have <a target="_blank" href="20121201-cert-pinning.html">talked about before</a>: HTTP Public Key Pinning (<a target="_blank" href="https://tools.ietf.org/html/draft-ietf-websec-key-pinning">HPKP</a>). This feature allows a website to tell the browser only to connect to the site if it is using a particular set of SSL certificates. For example, a site can specify that the browser only use a particular CA (certificate authority) or set of CAs when communicating with its servers.</p>
  <p>On to <a target="_blank" href="https://code.google.com/p/chromium/issues/detail?id=316032">the bug</a>...</p>
  <p>Without <a target="_blank" href="https://codereview.chromium.org/86043003/">this patch</a> an evil website has the ability to fill up your hard drive, or at least up to about 16 <a target="_blank" href="http://en.wikipedia.org/wiki/Exabyte">exabytes</a>.</p>
  <p><a href="papers/hpkpwn">[...READ MORE...]</a></p>

</article>


<article>
  <header>
	  <h1 class="title"><a href="20131028-training-users.html">Training Users to Be More Secure</a></h1>
	  <time class="pubdate" datetime="2013-10-28">2013-10-28</time>

  </header>
  <p>One of the things that a corporation, website, or mobile application should do, is in all of its interactions with the users of its services insure that none of the actions that it requests or requires would be something that in a malicious context would compromise the security those users.</p>
  <p>You should not do things like: have users enter credentials over a non-SSL log-in screen, force users to click through an invalid certificate to get to your site, or use a pseudo-public piece of data for a password (e.g. SSN or birthday).</p>
  <p>Last week, LinkedIn broke the rule of not requiring the user to engage in risky behavior. The service <a target="_blank" href="http://engineering.linkedin.com/mobile/linkedin-intro-doing-impossible-ios">Intro</a> is described as a <a target="_blank" href="http://blogs.csoonline.com/application-security/2808/linkedin-intro-data-meet-security-issues">bad idea</a> by Dave Lewis <a target="_blank" href="http://threatpost.com/linkedin-intro-app-equivalent-to-man-in-the-middle-attack-experts/">and</a> <a target="_blank" href="http://bits.blogs.nytimes.com/2013/10/24/linkedins-new-mobile-app-called-a-dream-for-attackers/">others</a>, was <a target="_blank" href="http://blog.linkedin.com/2013/10/26/the-facts-about-linkedin-intro/">rebutted</a> by a LinkedIn security manager which sparked a reply by Martin McKeay. Up to now, I have seen many people talking about how bad an idea the system is as a whole, so I will not rehash that part. Instead, I want to focus on the <i>how</i> not the what.</p>
  <p>Which brings me back to forcing users to engage in risky behavior. The way that you 'install' Intro, is to first, go to the Intro website rather than the app store. One of iOS's most lauded features is that it is kept more secure only allowing apps from the app store. Getting an app or 'app' from elsewhere should raise red flags.</p>
  <p>Next, you enter in your Gmail/iCloud/Yahoo/AOL/etc. email password, on LinkedIn's site. You should not enter your password for one site on another. It is reasonable for sites to want functionality that would normally need other sites credentials, but this is why things like <a target="_blank" href="http://en.wikipedia.org/wiki/OAuth">oAuth</a> and <a target="_blank" href="http://en.wikipedia.org/wiki/SAML_2.0">SAML</a> were created.</p>
  <p>Next, you are required to install a <a target="_blank" href="https://developer.apple.com/library/ios/featuredarticles/iPhoneConfigurationProfileRef/">configuration profile</a>. Configuration profiles very useful for giving corporations access to a phone. As <a target="_blank" href="http://www.bishopfox.com/blog/2013/10/linkedin-intro/">Bishop Fox said</a>, "A profile can be used to wipe your phone, install applications, delete applications, restrict functionality, and a whole heap of other things". Users should only install these profiles if they truly understand what they do, or are required to by their company.</p>
  <p>Also, using this method, there is a set of certificates installed by the mobile config profile. This is a further potential avenue for compromise in a malicious setting. Configuration profiles in iOS are powerful things, training users to install them can lead to making it a lot easier to pull off a social engineering trick, similar to what I described in my <a target="_blank" href="http://www.cem.me/papers/bslides.pptx">BSides San Antonio talk</a> (starting slide 26).</p>
  <p>Make the Internet a better place: as a website/app/service provider you should choose an architecture using methods that propagate more secure, rather than risky, behavior.</p>
  <p>Happy Cyber Security Awareness Month</p>
  <p>-cem</p>
</article>


<article>
  <header>
	  <h1 class="title"><a href="all.html">[...more...]</a></h1>
  </header>
</article>


<footer>
	<cite>Copyright &copy; Carl Mehner</cite>
</footer>

</body>
</html>

